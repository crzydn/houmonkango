<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>大阪市西成区の精神科訪問看護なら いわき訪問看護ステーション</title>
  <meta name="description" content="大阪市西成区で24時間対応の精神科訪問看護ステーション。仕事帰りの傾聴サポートから生活保護申請まで専門看護師が寄り添います。" />
  <!-- OGP -->
  <meta property="og:title" content="大阪市西成区の精神科訪問看護なら いわき訪問看護ステーション" />
  <meta property="og:description" content="精神科訪問看護を通じて、心に寄り添うサポートを行います。24時間365日対応可能。" />
  <meta property="og:image" content="iwaki-logo.png" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://crzydn.github.io/iwaki-houmonkango/" />

  <!-- Font Awesome（integrityを削除して確実に読み込む） -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">

<style>
/* ===== 基本 ===== */
html { scroll-behavior: smooth; font-size: 16px; }
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'Hiragino Sans','Noto Sans JP',sans-serif; background: #eef4f7; color: #222; line-height: 1.6; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
a { text-decoration: none; color: inherit; }
.container { width: 100%; max-width: 1024px; margin: auto; padding: 0 1rem; }

/* ===== ヘッダー ===== */
header { position: sticky; top: 0; background: #fff; box-shadow: 0 2px 6px rgba(0,0,0,0.08); z-index: 2000; }
.header-inner {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.6rem 1rem;
  justify-content: space-between;
}
.logo { display:flex; align-items:center; flex:0 0 auto; }
.logo img { height: 48px; width: auto; display:block; }

/* nav layout: desktop */
nav { flex: 1 1 auto; display:flex; justify-content:flex-end; align-items:center; }
nav ul { display:flex; gap:1rem; align-items:center; margin:0; padding:0; list-style:none; white-space:nowrap; }
nav li { list-style:none; }
nav a { font-size:0.95rem; padding:0.35rem 0.6rem; display:inline-block; line-height:1; transition: color 0.18s ease; }
nav a:hover, nav a:focus { color:#2b8f6e; outline:none; }

.header-btn {
  background:#00c300;
  color:#fff;
  padding:0.45rem 0.9rem;
  border-radius:20px;
  font-weight:600;
  font-size:0.92rem;
  display:inline-flex;
  align-items:center;
  gap:0.5rem;
  box-shadow:0 2px 6px rgba(0,0,0,0.08);
  white-space:nowrap;
}
.header-btn i { display:inline-block; font-size:1.05rem; }

/* hamburger (visible on mobile) */
.nav-toggle {
  display: none;
  background: transparent;
  border: none;
  font-size: 1.25rem;
  cursor: pointer;
  padding: 0.35rem;
  color: #333;
}

/* ===== mobile: nav slides out from right ===== */
@media (max-width: 768px) {
  .logo img { height:44px; }
  .nav-toggle { display:inline-flex; align-items:center; justify-content:center; }

  /* nav is hidden by default, slides from right */
  nav {
    position: fixed;
    top: 0;
    right: -100%; /* hidden off-canvas */
    height: 100vh;
    width: 320px;
    max-width: 86%;
    background: #fff;
    display:flex;
    flex-direction:column;
    align-items:flex-start;
    padding: 1.2rem 1rem; /* 小さめのtop padding: 項目が上に寄る */
    box-shadow: -6px 0 18px rgba(0,0,0,0.08);
    transition: right 0.28s ease;
    z-index: 3000;
  }
  nav.active { right: 0; }
  nav .nav-close {
    background: transparent;
    border: none;
    font-size: 1.6rem;
    color: #444;
    position: absolute;
    top: 12px;
    right: 12px;
    padding: 8px;
    cursor: pointer;
  }
  nav ul { flex-direction: column; align-items:stretch; width:100%; gap:0; margin-top: 6rem; /* 少し余白をタイトル領域分確保 */ }
  /* もしメニューをより上に出したければ margin-top を小さくしてください */
  nav a { padding: 0.9rem 1rem; border-radius:6px; display:block; color:#214a3b; }
  nav li + li { margin-top: 0.25rem; }
  nav .header-btn { margin-top:0.6rem; width:calc(100% - 2rem); justify-content:center; }
}

/* ===== ヒーロー ===== */
.hero { position: relative; background: url('https://example.com/hero.jpg') center/cover no-repeat; text-align: center; color: #fff; padding: calc(2.5rem + 64px) 1rem 2rem; }
.hero::after { content: ''; position: absolute; inset: 0; background: rgba(0,0,0,0.48); }
.hero .content { position: relative; z-index: 1; max-width: 840px; margin: auto; }
.hero h1 { font-size: 1.9rem; margin-bottom: 0.8rem; line-height: 1.22; }
.hero p { font-size: 1rem; margin-bottom: 1.2rem; color: rgba(255,255,255,0.95); }
.btn-primary { background: #fff; color: #2b8f6e; padding: 0.8rem 1.4rem; border-radius: 20px; font-weight: 600; font-size: 1rem; box-shadow: 0 2px 10px rgba(0,0,0,0.12); transition: transform 0.18s ease; display:inline-flex; align-items:center; gap:0.5rem; }
.btn-primary:hover { transform: translateY(-3px); }

/* ===== セクション共通 ===== */
.section { background: #fff; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin: 1.5rem 0; padding: 1.5rem; }
.section h2 { font-size: 1.4rem; color: #2b8f6e; margin-bottom: 1rem; position: relative; }
.section h2::after { content: ''; display: block; width: 56px; height: 3px; background: #2b8f6e; border-radius: 2px; position: absolute; bottom: -8px; left: 0; }

/* ===== カード ===== */
.cards { display:flex; flex-wrap:wrap; gap:1rem; }
.card { flex: 1 1 calc(50% - 1rem); background:#fafafa; padding:1rem; border-radius:10px; box-shadow:0 1px 6px rgba(0,0,0,0.04); transition: transform .18s ease; min-width:220px; }
.card h3 { font-size:1.1rem; margin-bottom:0.5rem; display:flex; align-items:center; gap:0.5rem; }
.card p { font-size:0.95rem; color:#444; }
.cute-icon { font-size:1.6rem; color:#2b8f6e; margin-right:0.5rem; }
.card:hover, .card:focus-within { transform: translateY(-4px); background:#f7fffa; }

@media (max-width:680px) { .card { flex: 1 1 100%; } }

/* ===== 活動地域 ===== */
.region-map img { width:100%; height:auto; border-radius:8px; display:block; }
.region-list { display:flex; flex-wrap:wrap; gap:0.8rem; margin-top:1rem; }
.region-list li { background:#2b8f6e; color:#fff; padding:0.45rem 0.9rem; border-radius:6px; font-size:0.92rem; }

/* ===== ニュースティッカー ===== */
.news-ticker { background:#eef9f4; overflow:hidden; border-radius:8px; padding:0.35rem 0; }
.ticker { display:inline-block; white-space:nowrap; transform:translateX(0); will-change:transform; }
.ticker span { display:inline-block; padding:0.5rem 1.75rem; color:#214a3b; font-size:0.95rem; }

/* ===== ボタン ===== */
.btn-download { background: linear-gradient(135deg,#2b8f6e,#1f7a63); color:#fff; padding:0.6rem 1rem; border-radius:25px; font-size:0.95rem; display:inline-flex; gap:0.5rem; align-items:center; }
.btn-download:hover { transform: translateY(-3px); }

/* ===== テーブル（改善） ===== */
.table-responsive { overflow-x:auto; margin-bottom:1.5rem; }
table { width:100%; border-collapse:collapse; /* table-layout を auto にして自然な折返しに */ }
th, td { border:1px solid #e6e6e6; padding:0.75rem; text-align:center; font-size:0.95rem; vertical-align:middle; word-break: normal; overflow-wrap: normal; }
th { background:#e8f9f1; color:#214a3b; font-weight:700; }
tbody tr:nth-child(odd) { background:#fbfdfc; }

/* 列幅は推奨（PC） */
th:nth-child(1), td:nth-child(1) { width:52%; }
th:nth-child(2), td:nth-child(2) { width:24%; }
th:nth-child(3), td:nth-child(3) { width:24%; }

/* prevent characters from breaking vertically in time cells */
table td:first-child { white-space: nowrap; }

/* モバイルでのテーブル見せ方 */
@media (max-width:768px) {
  table, thead, tbody, th, td, tr { display:block; }
  thead tr { display:none; }
  tbody tr { margin-bottom:0.9rem; border-radius:8px; overflow:hidden; box-shadow:0 1px 4px rgba(0,0,0,0.03); background:#fff; }
  td { position:relative; padding-left:50%; text-align:right; white-space: normal; } /* allow wrapping in small screens for long labels */
  td::before { content: attr(data-label); position:absolute; left:0.9rem; width:calc(50% - 1.8rem); text-align:left; font-weight:700; color:#333; }
  /* ensure first column still readable */
  td:first-child { padding-left:0.9rem; text-align:left; }
}

/* ===== バッジ ===== */
.badge-ok { background:#2b8f6e; color:#fff; padding:6px 10px; border-radius:8px; font-size:0.86rem; display:inline-block; }
.badge-consult { background:#ff9800; color:#fff; padding:6px 10px; border-radius:8px; font-size:0.86rem; display:inline-block; }

/* ===== モーダル ===== */
.modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); z-index:2000; padding:2rem 1rem; }
.modal[aria-hidden="false"] { display:block; }
.modal-content { background:#fff; margin:0 auto; padding:1rem; width:100%; max-width:840px; border-radius:10px; position:relative; box-shadow:0 12px 36px rgba(0,0,0,0.14); }
.modal-close { position:absolute; top:12px; right:12px; font-size:1.2rem; cursor:pointer; background:transparent; border:none; color:#666; padding:6px; border-radius:6px; }
.modal-close:focus { box-shadow:0 0 0 4px rgba(43,143,110,0.12); }

/* modal iframe */
.modal-content iframe { width:100%; height:70vh; border:none; border-radius:6px; }

/* ===== 浮動LINEボタン ===== */
.floating-line { position:fixed; bottom:18px; right:18px; width:56px; height:56px; background:#00c300; border-radius:50%; display:flex; align-items:center; justify-content:center; box-shadow:0 6px 18px rgba(0,0,0,0.12); z-index:1500; }
.floating-line a { color:#fff; font-size:1.4rem; display:inline-flex; align-items:center; justify-content:center; }

/* ===== フッター ===== */
footer { text-align:center; padding:1rem 0; background:#2b8f6e; color:#fff; font-size:0.85rem; }

/* ===== レスポンシブ微調整 ===== */
@media (max-width:480px) {
  .hero h1 { font-size:1.4rem; }
  .hero p { font-size:0.95rem; }
  .cards { gap:0.6rem; }
  .card { padding:0.9rem; border-radius:8px; }
  .region-list li { font-size:0.88rem; padding:0.35rem 0.6rem; }
  .btn-primary, .btn-download { width:100%; justify-content:center; }
}
</style>
</head>
<body>
  <header>
    <div class="container header-inner">
      <div class="logo">
        <img src="iwaki-logo.png" alt="いわき訪問看護ステーション ロゴ">
      </div>

      <!-- ハンバーガー（右側） -->
      <button class="nav-toggle" aria-label="メニュー" aria-expanded="false">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>

      <nav aria-label="メインナビゲーション">
        <!-- モバイル時の閉じるボタン -->
        <button class="nav-close" aria-label="閉じるメニュー" style="display:none;">&times;</button>

        <ul>
          <li><a href="#hero">ホーム</a></li>
          <li><a href="#services">サービス</a></li>
          <li><a href="#region">活動地域</a></li>
          <li><a href="#fees">料金表</a></li>
          <li><a href="#contracts">契約書</a></li>
          <li><a href="#staff">スタッフ対応</a></li>
          <li><a href="#contact" class="header-btn"><i class="fa-brands fa-line" aria-hidden="true"></i> 無料相談</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- ヒーロー -->
  <section id="hero" class="hero">
    <div class="content container" role="region" aria-label="トップメッセージ">
      <h1>「今日も一人で頑張ったな…」<br>そんな夜を、<br>少しでも安心に包みたい。</h1>
      <p>大阪市西成区で仕事帰りの“聴き手”や、生活保護支援を求めるあなたへ。専門の精神科看護師が、誰にも話せない心の声に寄り添います。</p>
      <a href="#contact" class="btn-primary"><i class="fa-brands fa-line" aria-hidden="true"></i> 無料相談</a>
      <div class="hero-small">LINE・電話・メールでお気軽にどうぞ</div>
    </div>
  </section>

  <main class="container" id="content">
    <!-- ... (以下は既存の各セクションを省略せずそのまま配置してください) ... -->

    <!-- Services -->
    <section id="services" class="section" aria-labelledby="services-title">
      <h2 id="services-title"><i class="fa-solid fa-brain" aria-hidden="true"></i> 精神科訪問看護でできること</h2>
      <div class="cards">
        <div class="card" tabindex="0">
          <h3><i class="fa-solid fa-headset cute-icon" aria-hidden="true"></i> 傾聴サポート</h3>
          <p>仕事帰りの疲れや孤独感、何でもお気軽にお話しください。</p>
        </div>
        <div class="card" tabindex="0">
          <h3><i class="fa-solid fa-heart-pulse cute-icon" aria-hidden="true"></i> メンタルヘルスチェック</h3>
          <p>不安や抑うつ状態を定期的に確認し、早期対応を行います。</p>
        </div>
        <div class="card" tabindex="0">
          <h3><i class="fa-solid fa-pills cute-icon" aria-hidden="true"></i> 服薬管理</h3>
          <p>お薬の飲み忘れを防ぎ、安心して治療を継続できるようサポート。</p>
          <span class="badge-ok" aria-hidden="true">守秘義務厳守</span>
        </div>
        <div class="card" tabindex="0">
          <h3><i class="fa-solid fa-triangle-exclamation cute-icon" aria-hidden="true"></i> 緊急対応</h3>
          <p>急な不調時には迅速に対応し、安全を確保します。</p>
          <span class="badge-consult" aria-hidden="true">24時間対応</span>
        </div>
        <div class="card" tabindex="0">
          <h3><i class="fa-solid fa-person-walking-arrow-loop-left cute-icon" aria-hidden="true"></i> セルフケア指導</h3>
          <p>簡単な呼吸法やリラクゼーション技法をお伝えします。</p>
        </div>
        <div class="card" tabindex="0">
          <h3><i class="fa-solid fa-file-circle-check cute-icon" aria-hidden="true"></i> 生活保護申請サポート</h3>
          <p>申請手続きを一緒に整理し、不安を軽減します。</p>
          <span class="badge-ok" aria-hidden="true">無料相談</span>
        </div>
      </div>
      <p style="text-align:right; margin-top:1rem;"><a href="services-detail.html" class="btn-primary">詳しく見る →</a></p>
    </section>

    <!-- Region -->
    <section id="region" class="section">
      <h2><i class="fa-solid fa-map-location-dot" aria-hidden="true"></i> 活動地域</h2>
      <div class="region-map">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/58/Osaka_city_in_Osaka_prefecture_Japan.svg/640px-Osaka_city_in_Osaka_prefecture_Japan.svg.png" alt="大阪市の地図">
      </div>
      <ul class="region-list">
        <li>西成区</li>
        <li>浪速区</li>
        <li>阿倍野区</li>
        <li>住吉区</li>
        <li>平野区</li>
        <li>住之江区</li>
      </ul>
      <p style="text-align:right; margin-top:1rem;"><a href="region-detail.html" class="btn-primary">詳しく見る →</a></p>
    </section>

    <!-- News -->
    <section id="news" class="section">
      <h2><i class="fa-solid fa-newspaper" aria-hidden="true"></i> おしらせ</h2>
      <div class="news-ticker">
        <div class="ticker">
          <span>2025.07.09 テスト中です。</span>
          <span>2025.03.30 LINE対応開始しました。</span>
          <span>2025.01.10 看護記録開示公開しました。</span>
        </div>
      </div>
    </section>

    <!-- Fees -->
    <section id="fees" class="section">
      <h2><i class="fa-solid fa-file-invoice-dollar" aria-hidden="true"></i> 料金表</h2>
      <button class="btn-download" onclick="openModal('modal-fees')"><i class="fa-solid fa-file-pdf" aria-hidden="true"></i> PDFを見る</button>
      <p style="text-align:right; margin-top:1rem;"><a href="fees-detail.html" class="btn-primary">詳しく見る →</a></p>
    </section>

    <!-- Contracts -->
    <section id="contracts" class="section">
      <h2><i class="fa-solid fa-file-contract" aria-hidden="true"></i> 契約書</h2>
      <button class="btn-download" onclick="openModal('modal-contracts')"><i class="fa-solid fa-file-contract" aria-hidden="true"></i> PDFを見る</button>
      <p style="text-align:right; margin-top:1rem;"><a href="contracts-detail.html" class="btn-primary">詳しく見る →</a></p>
    </section>

    <!-- Staff -->
    <section id="staff" class="section">
      <h2><i class="fa-solid fa-user-nurse" aria-hidden="true"></i> スタッフ訪問対応</h2>
      <div class="table-responsive" role="region" aria-label="スタッフ対応時間">
        <table>
          <thead>
            <tr><th scope="col">時間帯</th><th scope="col">男性看護師</th><th scope="col">女性看護師</th></tr>
          </thead>
          <tbody>
            <tr><td data-label="時間帯">08:00〜12:00</td><td data-label="男性看護師"><span class="badge-ok">対応可</span></td><td data-label="女性看護師"><span class="badge-ok">対応可</span></td></tr>
            <tr><td data-label="時間帯">12:00〜16:00</td><td data-label="男性看護師"><span class="badge-ok">対応可</span></td><td data-label="女性看護師"><span class="badge-ok">対応可</span></td></tr>
            <tr><td data-label="時間帯">16:00〜20:00</td><td data-label="男性看護師"><span class="badge-ok">対応可</span></td><td data-label="女性看護師"><span class="badge-consult">要相談</span></td></tr>
            <tr><td data-label="時間帯">20:00〜24:00</td><td data-label="男性看護師"><span class="badge-consult">要相談</span></td><td data-label="女性看護師"><span class="badge-ok">対応可</span></td></tr>
          </tbody>
        </table>
      </div>
      <p style="text-align:right; margin-top:1rem;"><a href="staff-detail.html" class="btn-primary">詳しく見る →</a></p>
    </section>

    <!-- Contact -->
    <section id="contact" class="section">
      <h2><i class="fa-solid fa-comments" aria-hidden="true"></i> お問い合わせ</h2>
      <p>LINE・電話・メールで24時間受付中。ご相談ください。</p>
      <div style="margin-top:1rem;">
        <a href="https://lin.ee/mlItwhZB" class="btn-primary" target="_blank" rel="noopener noreferrer"><i class="fa-brands fa-line" aria-hidden="true"></i> LINEで相談</a>
      </div>
      <p style="margin-top:1rem; font-size:0.95rem;">
        <i class="fa-solid fa-phone" aria-hidden="true"></i> <a href="tel:06-XXXX-XXXX">06-XXXX-XXXX</a><br>
        <i class="fa-solid fa-envelope" aria-hidden="true"></i> <a href="mailto:info@example.com">info@example.com</a>
      </p>
    </section>

    <!-- SNS -->
    <section id="sns" class="section">
      <h2><i class="fa-solid fa-hashtag" aria-hidden="true"></i> 各種SNS</h2>
      <p>最新情報や日々の様子をSNSでも発信しています。ぜひフォローしてください。</p>
      <div class="cards">
        <div class="card" style="text-align:center;">
          <a href="https://lin.ee/mlItwhZB" target="_blank" rel="noopener noreferrer">
            <i class="fa-brands fa-line cute-icon" aria-hidden="true" style="font-size:2rem;"></i>
            <h3>LINE公式アカウント</h3>
            <p>チャットで気軽にご相談</p>
          </a>
        </div>
        <div class="card" style="text-align:center;">
          <a href="https://twitter.com/xxxxxxxx" target="_blank" rel="noopener noreferrer">
            <i class="fa-brands fa-x cute-icon" aria-hidden="true" style="font-size:2rem;"></i>
            <h3>X（旧Twitter）</h3>
            <p>最新のお知らせを配信</p>
          </a>
        </div>
        <div class="card" style="text-align:center;">
          <a href="https://www.instagram.com/iwaki_houmonkango" target="_blank" rel="noopener noreferrer">
            <i class="fa-brands fa-instagram cute-icon" aria-hidden="true" style="font-size:2rem;"></i>
            <h3>Instagram</h3>
            <p>活動風景や日常を写真で</p>
          </a>
        </div>
        <div class="card" style="text-align:center;">
          <a href="https://www.facebook.com/xxxxxxxx" target="_blank" rel="noopener noreferrer">
            <i class="fa-brands fa-facebook-f cute-icon" aria-hidden="true" style="font-size:2rem;"></i>
            <h3>Facebook</h3>
            <p>地域の方との交流や情報発信</p>
          </a>
        </div>
      </div>
    </section>

    <!-- Careers ... Partners ...（省略せずそのまま置いてください） -->
  </main>

  <!-- モーダル：料金 -->
  <div id="modal-fees" class="modal" role="dialog" aria-hidden="true" aria-modal="true" aria-labelledby="modal-fees-title">
    <div class="modal-content">
      <button class="modal-close" aria-label="閉じる" data-modal-close>&times;</button>
      <h3 id="modal-fees-title" style="margin:0 0 .6rem 0;">料金表（PDF）</h3>
      <iframe src="fees.pdf" title="料金表"></iframe>
    </div>
  </div>

  <!-- モーダル：契約書 -->
  <div id="modal-contracts" class="modal" role="dialog" aria-hidden="true" aria-modal="true" aria-labelledby="modal-contracts-title">
    <div class="modal-content">
      <button class="modal-close" aria-label="閉じる" data-modal-close>&times;</button>
      <h3 id="modal-contracts-title" style="margin:0 0 .6rem 0;">契約書（PDF）</h3>
      <iframe src="contracts.pdf" title="契約書"></iframe>
    </div>
  </div>

  <!-- 浮動LINEボタン -->
  <div class="floating-line" aria-hidden="true">
    <a href="https://lin.ee/mlItwhZB" target="_blank" rel="noopener noreferrer"><i class="fa-brands fa-line" aria-hidden="true"></i></a>
  </div>

  <footer>
    <small>&copy; 2025 いわき訪問看護ステーション</small>
  </footer>

  <!-- JS -->
  <script>
(function () {
  // ===== ハンバーガー =====
  const navToggle = document.querySelector('.nav-toggle');
  const nav = document.querySelector('nav');
  const navClose = document.querySelector('.nav-close');

  // show/hide nav-close button only on mobile viewport
  function updateNavCloseVisibility() {
    if (!navClose) return;
    if (window.matchMedia('(max-width: 768px)').matches) {
      navClose.style.display = 'block';
    } else {
      navClose.style.display = 'none';
      nav.classList.remove('active');
      if (navToggle) navToggle.setAttribute('aria-expanded', 'false');
    }
  }
  updateNavCloseVisibility();
  window.addEventListener('resize', updateNavCloseVisibility);

  if (navToggle && nav) {
    navToggle.addEventListener('click', () => {
      const isActive = nav.classList.toggle('active');
      navToggle.setAttribute('aria-expanded', isActive ? 'true' : 'false');
      if (isActive) {
        // focus first menu item for accessibility
        const firstLink = nav.querySelector('a');
        if (firstLink) setTimeout(() => firstLink.focus(), 180);
      } else {
        navToggle.focus();
      }
    });

    // close nav when clicking outside (mobile)
    document.addEventListener('click', (e) => {
      if (!nav.classList.contains('active')) return;
      if (!nav.contains(e.target) && !navToggle.contains(e.target)) {
        nav.classList.remove('active');
        navToggle.setAttribute('aria-expanded', 'false');
      }
    });

    // close with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && nav.classList.contains('active')) {
        nav.classList.remove('active');
        navToggle.setAttribute('aria-expanded', 'false');
        navToggle.focus();
      }
    });

    // close button inside nav
    if (navClose) {
      navClose.addEventListener('click', () => {
        nav.classList.remove('active');
        navToggle.setAttribute('aria-expanded', 'false');
        navToggle.focus();
      });
    }
  }

  // ===== モーダル =====
  function trapFocus(container) {
    const focusableSelectors = 'a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])';
    const focusable = Array.from(container.querySelectorAll(focusableSelectors)).filter(el => el.offsetParent !== null);
    if (focusable.length === 0) return null;
    const first = focusable[0], last = focusable[focusable.length -1];
    function handler(e){
      if(e.key !== 'Tab') return;
      if(e.shiftKey) {
        if(document.activeElement === first){ e.preventDefault(); last.focus(); }
      } else {
        if(document.activeElement === last){ e.preventDefault(); first.focus(); }
      }
    }
    container.addEventListener('keydown', handler);
    return ()=>container.removeEventListener('keydown', handler);
  }

  const modals = Array.from(document.querySelectorAll('.modal'));
  const modalState = new Map();

  function openModalById(id) {
    const el = document.getElementById(id);
    if(!el) return;
    const content = el.querySelector('.modal-content');
    const previously = document.activeElement;
    el.setAttribute('aria-hidden','false');
    // focus close button
    setTimeout(() => {
      const closeBtn = el.querySelector('[data-modal-close]') || el.querySelector('.modal-close');
      if(closeBtn) closeBtn.focus();
    },150);
    const cleanup = trapFocus(content) || (()=>{});
    modalState.set(id,{cleanup,previously});
  }
  function closeModalById(id) {
    const el = document.getElementById(id);
    if(!el) return;
    el.setAttribute('aria-hidden','true');
    const state = modalState.get(id);
    if(state){
      state.cleanup();
      if(state.previously && state.previously.focus) state.previously.focus();
      modalState.delete(id);
    }
  }
  window.openModal = openModalById;
  window.closeModal = closeModalById;

  // wire close buttons and background click
  document.addEventListener('click', (e) => {
    if (e.target.matches('[data-modal-close]') || e.target.closest('[data-modal-close]')) {
      const modal = e.target.closest('.modal');
      if (modal && modal.id) closeModalById(modal.id);
      return;
    }
    if (e.target.classList && e.target.classList.contains('modal')) {
      closeModalById(e.target.id);
    }
  });

  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      modals.forEach(m => {
        if (m.getAttribute('aria-hidden') === 'false') closeModalById(m.id);
      });
    }
  });

  // ===== ニュースティッカー =====
  (function ticker() {
    const wrapper = document.querySelector('.news-ticker');
    const ticker = document.querySelector('.ticker');
    if (!wrapper || !ticker) return;
    let speed = 0.6;
    let x = 0;
    function update() {
      const tw = ticker.scrollWidth;
      const ww = wrapper.clientWidth;
      x -= speed;
      if (Math.abs(x) >= tw) x = ww;
      ticker.style.transform = `translateX(${x}px)`;
      requestAnimationFrame(update);
    }
    let raf = requestAnimationFrame(update);
    window.addEventListener('resize', () => { x = 0; });
  })();

})();
  </script>
</body>
</html>